<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Robot Sim</title>
    <style>* {background:rgb(52, 52, 54); margin: 0% } canvas { background: rgb(211, 211, 211); width: 100%; height: 100%}</style>
</head>
<body>

<canvas id="myCanvas"></canvas>

<div class="hcenter">
    <p id="time"></p>
</div>

<div class="hcenter">
    <input type="button" id="reset" value="Reset (R)" onclick="reset()" class="unpressed">
</div>

<div class="hcenter">
    <input type="button" id="mode1" value="Mode 1" onclick="mode1()" class="pressed">
    <input type="button" id="mode2" value="Mode 2" onclick="mode2()" class="unpressed">
    <input type="button" id="mode3" value="Mode 3" onclick="mode3()" class="unpressed">
</div>



<script>
    var canvas = document.getElementById("myCanvas");
    canvas.width  = 1200;
    canvas.height = 550;
    var ctx = canvas.getContext("2d");
    ctx.translate(canvas.width/2, canvas.height/2);
    ctx.transform(1, 0, 0, -1, 0, 0);


    var keys = {
        w: false,
        a: false,
        s: false,
        d: false,
        left: false,
        up: false,
        right: false,
        down: false,
        comma: false,
        period: false,
    };

    var robot = {
        width: 100,
        height: 125,

        x: -500,
        y: -200,
        ang: 0,
        wheel0ang: 0,
        wheel1ang: 0,
        wheel2ang: 0,
        wheel3ang: 0,
    }

    var moduleX = robot.width / 2 - 15;
    var moduleY = robot.height / 2 - 15;

    var startTime = new Date().getTime();
    var elapsedTime = 0;

    var paused = true;
    var mode = 1;

    setInterval(loop, 20);

    document.addEventListener("keydown", keydown);
    document.addEventListener("keyup", keyup);

    function loop() {


        if(!paused){
            elapsedTime = (new Date().getTime() - startTime) / 1000;


            greyOtherButtons();


            if(keys.w) robot.y += +1;
            if(keys.a) robot.x += -1;
            if(keys.s) robot.y += -1;
            if(keys.d) robot.x += +1;
            if(keys.left) robot.ang += +0.1;
            if(keys.right) robot.ang += -0.1;            


            
        }else{

            if(keys.w || keys.a || keys.s || keys.d || keys.left || keys.right){
                paused = false;
                startTime = new Date().getTime();
            }else{
                ungreyOtherButtons();
            }
        }
        document.getElementById("time").innerText = "Elasped Time: " + elapsedTime.toFixed(2);
        draw();
    }

    function draw(){
        ctx.clearRect(-canvas.width/2, -canvas.height/2, canvas.width, canvas.height);

        ctx.save();

        ctx.translate(robot.x, robot.y);
        ctx.rotate(robot.ang)
        ctx.fillStyle = "rgb(51, 102, 255)";
        ctx.fillRect(-robot.width/2, -robot.height/2, robot.width, robot.height)

        ctx.fillStyle = "rgb(50, 50, 50)";
        drawModule(+moduleX, +moduleY, Math.PI);
        drawModule(-moduleX, +moduleY, Math.PI);
        drawModule(-moduleX, -moduleY, Math.PI);
        drawModule(+moduleX, -moduleY, Math.PI);

        ctx.restore();

    }

    function drawModule(x, y, ang){
        ctx.beginPath();
        ctx.arc(x, y, 10, 0, 2 * Math.PI);
        ctx.fill();
    }

    function reset(){
        document.getElementById("reset").className = "pressed";
        elapsedTime = 0;
        robot.x = -500;
        robot.y = -200;
        robot.ang = 0;
        wheel0ang = 0,
        wheel1ang = 0,
        wheel2ang = 0,
        wheel3ang = 0,
        paused = true;
    }






    // This function will be called when a key on the keyboard is pressed
    function keydown(e) {

        if(e.keyCode == 87) keys.w = true;
        if(e.keyCode == 65) keys.a = true;
        if(e.keyCode == 83) keys.s = true;
        if(e.keyCode == 68) keys.d = true;

        if(e.keyCode == 37) keys.left = true;
        if(e.keyCode == 38) keys.up = true;
        if(e.keyCode == 39) keys.right = true;
        if(e.keyCode == 40) keys.down = true;

        if(e.keyCode == 188) keys.comma = true;
        if(e.keyCode == 190) keys.period = true;

        if(e.keyCode == 82){
            reset();
        }
    }
    function keyup(e) {
        if(e.keyCode == 87) keys.w = false;
        if(e.keyCode == 65) keys.a = false;
        if(e.keyCode == 83) keys.s = false;
        if(e.keyCode == 68) keys.d = false;

        if(e.keyCode == 37) keys.left = false;
        if(e.keyCode == 38) keys.up = false;
        if(e.keyCode == 39) keys.right = false;
        if(e.keyCode == 40) keys.down = false;

        if(e.keyCode == 188) keys.comma = false;
        if(e.keyCode == 190) keys.period = false;

        if(e.keyCode == 49) mode1();
        if(e.keyCode == 50) mode2();
        if(e.keyCode == 51) mode3();
    }

    function mode1(){
        if(paused){
            document.getElementById("mode1").className = "pressed";
            document.getElementById("mode2").className = "unpressed";
            document.getElementById("mode3").className = "unpressed";
            mode = 1;
        }
    }
    function mode2(){
        if(paused){
            document.getElementById("mode1").className = "unpressed";
            document.getElementById("mode2").className = "pressed";
            document.getElementById("mode3").className = "unpressed";
            mode = 2;
        }
    }
    function mode3(){
        if(paused){
            document.getElementById("mode1").className = "unpressed";
            document.getElementById("mode2").className = "unpressed";
            document.getElementById("mode3").className = "pressed";
            mode = 3;
        }
    }
    function greyOtherButtons(){
        document.getElementById("mode1").className = "greyed";
        document.getElementById("mode2").className = "greyed";
        document.getElementById("mode3").className = "greyed";

        document.getElementById("mode" + mode).className = "pressed";
        document.getElementById("reset").className = "unpressed";
    }
    function ungreyOtherButtons(){
        document.getElementById("mode1").className = "unpressed";
        document.getElementById("mode2").className = "unpressed";
        document.getElementById("mode3").className = "unpressed";

        document.getElementById("mode" + mode).className = "pressed";
        document.getElementById("reset").className = "unpressed";
    }


</script>

</body>
</html>

<style>
    .hcenter{
        text-align: center;
        padding: 5px 5px;
        color:whitesmoke;
        font-size: 20px;
        font-family: Monaco, sans-serif;
    }

    .unpressed{
        padding: 10px 20px;
        background-color: rgb(101, 114, 133);
        border: none;
        color: whitesmoke;
        cursor: pointer;
        font-size: 15px;
        font-family: Monaco, sans-serif;

    }

    .pressed{
        padding: 10px 20px;
        background-color: rgb(113, 224, 187);
        border: none;
        font-size: 15px;
        font-family: Monaco, sans-serif;

    }

    .greyed{
        padding: 10px 20px;
        background-color: rgb(172, 172, 172);
        border: none;
        font-size: 15px;
        font-family: Monaco, sans-serif;
    }


</style>